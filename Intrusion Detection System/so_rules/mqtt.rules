
alert tcp any any -> any 1883 (msg:"Unexpected MQTT Connect Packet Size"; content:"|10|"; dsize:<10; sid:1000026;)
alert tcp any any -> any 1883 (msg:"MQTT Subscribe to Multiple Topics"; content:"|82|"; byte_test:2,>,1,1; sid:1000027;)
alert tcp any any -> any 1883 (msg:"MQTT Unsubscribe Request"; content:"|A2|"; sid:1000028;)
alert tcp any any -> any 1883 (msg:"MQTT Protocol Violation: QoS 0 with Packet Identifier"; content:"|30 00|"; sid:1000029;)
alert tcp any any -> any 1883 (msg:"MQTT Ping without Activity"; content:"|C0 00|"; flowbits:set,mqtt_ping; flowbits:noalert; flowbits:isset,mqtt_activity; sid:1000030; flowbits:unset,mqtt_activity;)
alert tcp any any -> any 1883 (msg:"MQTT Publish with Retain Flag in Non-Compliant Context"; content:"|30|"; byte_test:1,&,0x01,0; flow:not_established; sid:1000031;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Will Flag but No Will Topic"; content:"|10|"; byte_test:1,&,0x04,0; content:"|00 00|"; within:4; distance:10; sid:1000032;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Insecure Protocol Version"; content:"|10|"; content:"MQIsdp"; sid:1000033;)
alert tcp any any -> any 1883 (msg:"MQTT Publish to Unauthorized Topic"; content:"|30|"; content:"unauthorized/topic"; sid:1000034;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Invalid Keep Alive Value"; content:"|10|"; byte_test:2,<,10,1; sid:1000035;)
alert tcp any any -> any 1883 (msg:"Excessive MQTT Connect Requests from Same Source"; content:"|10|"; detection_filter: track by_src, count 20, seconds 30; sid:1000036;)
alert tcp any any -> any 1883 (msg:"MQTT Publish to System Topic by Non-Admin"; content:"|30|"; content:"$SYS/"; content:"non-admin-client"; sid:1000037;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Invalid QoS Level 2"; content:"|10|"; byte_test:2,&,96,0; sid:1000038;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Invalid Username/Password Length"; content:"|10|"; content:"|00|"; within:2; distance:14; sid:1000039;)
alert tcp any any -> any 1883 (msg:"MQTT Publish with Invalid Fixed Header"; content:"|30|"; byte_test:1,!&,0x03,0; sid:1000040;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Unusual Client ID"; content:"|10|"; content:"suspicious_id"; sid:1000041;)
alert tcp any any -> any 1883 (msg:"MQTT Subscribe with Invalid QoS Level 3"; content:"|82|"; byte_test:2,&,96,0; sid:1000042;)
alert tcp [blacklisted IP] any -> any 1883 (msg:"MQTT Connect from Blacklisted IP"; content:"|10|"; sid:1000044;)
alert tcp any any -> any 1883 (msg:"MQTT Subscribe with Invalid QoS Level 3"; content:"|82|"; byte_test:2,&,96,0; sid:1000042;)
alert tcp any any -> any 1883 (msg:"MQTT Publish to Broadcast Topic"; content:"|30|"; content:"broadcast/"; sid:1000045;)
alert tcp any any -> any 1883 (msg:"MQTT Connect without Will Message with Will Flag"; content:"|10|"; byte_test:1,&,0x04,0; content:"|00 00|"; within:4; distance:12; sid:1000046;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Excessive Username Length"; content:"|10|"; byte_test:2,>,100,1; sid:1000047;)
alert tcp any any -> any 1883 (msg:"MQTT Subscribe with Invalid Topic Length"; content:"|82|"; byte_test:2,<,3,1; sid:1000048;)
alert tcp any any -> any 1883 (msg:"MQTT Packet with Invalid Remaining Length Encoding"; content:"|30|"; byte_test:1,&,0x80,0; sid:1000049;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Suspicious Payload"; content:"|10|"; content:"malware_signature"; sid:1000050;)
alert tcp any any -> any 1883 (msg:"MQTT Publish with Duplicate Packet Identifier"; content:"|30|"; flowbits:set,mqtt_dup_id; flowbits:noalert; sid:1000051; flowbits:isset,mqtt_dup_id;)
alert tcp [IP range for unusual location] any -> any 1883 (msg:"MQTT Connect from Unusual Geographic Location"; content:"|10|"; sid:1000052;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Incompatible Protocol Level"; content:"|10|"; byte_test:1,=,5,2; sid:1000053;)
alert tcp any any -> any 1883 (msg:"MQTT Publish to Forbidden Topic"; content:"|30|"; content:"forbidden/topic"; sid:1000054;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Invalid Header Flags"; content:"|10|"; byte_test:1,!&,0xFC,0; sid:1000055;)
alert tcp any any -> any 1883 (msg:"MQTT Publish with Non-UTF8 Encoded Topic"; content:"|30|"; content:"|C2|"; sid:1000056;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Excessive Payload Length"; content:"|10|"; byte_test:2,>,1024,1; sid:1000057;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Suspiciously Short Keep Alive"; content:"|10|"; byte_test:2,<,5,1; sid:1000058;)
alert tcp any any -> any 1883 (msg:"MQTT Publish QoS 0 with Retain Flag"; content:"|30 00|"; sid:1000059;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Will Topic but No Will Message"; content:"|10|"; content:"will/topic"; content:"|00 00|"; distance:0; within:4; sid:1000060;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Null Character in Client ID"; content:"|10|"; content:"|00|"; sid:1000061;)
alert tcp any any -> any 1883 (msg:"MQTT Publish with Suspiciously Long Topic Name"; content:"|30|"; byte_test:2,>,256,1; sid:1000062;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Misaligned Packet Length"; content:"|10|"; byte_test:2,!=,dsize,-2; sid:1000063;)
alert tcp any any -> any 1883 (msg:"MQTT Subscribe with Non-Compliant Topic Filter"; content:"|82|"; content:"invalid/filter"; sid:1000064;)
alert tcp any any -> any 1883 (msg:"MQTT Publish with Invalid Packet Length"; content:"|30|"; byte_test:1,>,dsize,-1; sid:1000065;)
alert tcp any any -> any 1883 (msg:"MQTT Publish with QoS Level Mismatch"; content:"|30|"; byte_test:1,&,0x06,0; content:"|00 01|"; sid:1000066;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Empty Client ID and Clean Session Disabled"; content:"|10|"; content:"|00 00|"; byte_test:1,!&,0x02,0; sid:1000067;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Inconsistent Username/Password Flags"; content:"|10|"; byte_test:1,!&,0xC0,0; sid:1000068;)
alert tcp any any -> any 1883 (msg:"MQTT Subscribe to Nonexistent Topic"; content:"|82|"; content:"nonexistent/topic"; sid:1000069;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Forbidden Client ID"; content:"|10|"; content:"forbidden_id"; sid:1000070;)
alert tcp any any -> any 1883 (msg:"MQTT Publish QoS 1 without Packet Identifier"; content:"|32 00|"; sid:1000071;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Unsupported Features"; content:"|10|"; content:"unsupported_feature"; sid:1000072;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with Incorrect Protocol Name"; content:"|10|"; content:"InvalidProtocol"; sid:1000073;)
alert tcp any any -> any 1883 (msg:"MQTT Connect with High Byte in Remaining Length"; content:"|10|"; byte_test:1,>,127,1; sid:1000074;)

